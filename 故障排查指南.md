# 🔍 悬浮球不显示 - 故障排查指南

## 第一步：检查扩展是否正确加载

### 1. 检查Chrome扩展页面
1. 访问：`chrome://extensions/`
2. 找到 **Prompt Stock**
3. 检查以下几点：

   **✅ 应该看到：**
   - 扩展已启用（开关是蓝色的）
   - 没有红色错误提示
   - 版本显示为 1.0.0

   **❌ 如果看到错误：**
   - 截图错误信息
   - 告诉我具体的错误内容

### 2. 检查是否有图标
如果扩展卡片上没有图标（显示默认图标）：
- 说明图标文件还没有添加
- 这不影响功能，但需要添加图标才能完全加载成功

---

## 第二步：检查控制台

### 打开开发者工具
1. 在 `https://chat.deepseek.com` 页面
2. 按 `F12` 打开开发者工具
3. 切换到 **Console（控制台）** 标签

### 查看是否有错误
- **有红色错误？** → 截图告诉我
- **没有任何消息？** → 说明content script可能没有注入

---

## 第三步：检查访问的URL

### 确认URL完全匹配
默认配置只在这个域名显示：
```
https://chat.deepseek.com
```

**检查你访问的URL：**
- ✅ 正确：`https://chat.deepseek.com` 或 `https://chat.deepseek.com/xxx`
- ❌ 错误：`http://chat.deepseek.com`（没有s）
- ❌ 错误：`www.chat.deepseek.com`

---

## 第四步：强制刷新

### 刷新扩展
1. 在 `chrome://extensions/` 页面
2. 找到 Prompt Stock
3. 点击 **刷新图标** 🔄
4. 关闭并重新打开 chat.deepseek.com 页面

### 硬刷新页面
在 chat.deepseek.com 页面：
- 按 `Ctrl + Shift + R`（Windows）
- 或 `Ctrl + F5`

---

## 快速测试：临时显示在所有网站

如果你想快速测试功能，先让它在所有网站显示：

### 方法A：修改代码（临时）
1. 打开 `src/utils/storage.ts`
2. 找到第80-86行的 `isCurrentDomainEnabled` 函数
3. 临时改成：
   ```typescript
   export const isCurrentDomainEnabled = (): boolean => {
     return true; // 临时：在所有网站显示
   };
   ```
4. 运行 `npm run build`
5. 刷新Chrome扩展
6. 访问任意网站都会显示

### 方法B：通过设置添加当前网站
如果悬浮球能显示，可以：
1. 打开侧边栏
2. 点击设置
3. 添加你想要的域名

---

## 详细诊断信息

请提供以下信息，我可以更准确地帮你：

### 1. 扩展状态
- [ ] 扩展已启用
- [ ] 扩展有图标
- [ ] 扩展没有错误提示

### 2. 访问的URL
```
你访问的完整URL：_______________________
```

### 3. 控制台信息
```
F12控制台中的错误或消息：_______________________
```

### 4. 图标是否已生成
- [ ] 已生成图标并放到 public/icons/
- [ ] 重新运行了 npm run build
- [ ] 看到了 "✓ Copied iconXX.png" 的成功消息

---

## 最可能的原因

### 原因1：图标未生成（最常见）
**症状：** Chrome扩展页面显示错误
**解决：** 
1. 打开 `scripts/generate-icons.html`
2. 下载图标
3. 放到 `public/icons/`
4. `npm run build`

### 原因2：URL不匹配
**症状：** 扩展正常，但某些页面不显示
**解决：** 在设置中添加该域名

### 原因3：扩展未刷新
**症状：** 修改代码后没有生效
**解决：** 在 chrome://extensions/ 点击刷新

---

## 快速验证脚本

在 chat.deepseek.com 页面的控制台（F12）中运行：

```javascript
// 检查扩展是否注入
console.log('检查扩展根元素:', document.getElementById('prompt-stock-root'));

// 检查localStorage中的设置
console.log('当前设置:', localStorage.getItem('prompt_stock_settings'));

// 检查当前URL
console.log('当前URL:', window.location.href);
```

把输出结果告诉我！

